{% extends "base.html" %}

{% block content %}
<head>
    <title>Executed Trades</title>
</head>
<body>
    <h1>{% if status == "0" %}Planned trades
        {% elif status == "1" %}Scheduled trades
        {% else %}Executed trades
        {% endif%}</h1>
    {% for opp in trading_opps %}
        <h2>{{ opp.ticker.symbol }} - {{ opp.strategy.name }} (ID: {{ opp.id }})</h2>
          <form method="post" action="{% url 'update_tradingopp' opp.id %}">{% csrf_token %}
              <input type="hidden" name="opp_status" value="{{ status }}">
              {{ opp.action_buy|yesno:"BUY,SELL" }}<br>
              id: {{ opp.id }}<br>
              {% if opp.reward_risk %}<br>Reward/Risk: {{ opp.reward_risk }} %<br>{% endif %}
              {% if opp.trade_profit %}<br>Trade profit: {{ opp.trade_profit }}{% endif %}<br>
              <img src="{% url 'swing_point_graph' opp_id=opp.id %}" alt="Swing Points Graph" style="width: 400px; height: auto;"><br>
              <a href="{% url 'ticker_detail' opp.ticker.id %}" target="_blank">{{ opp.ticker.symbol }}<br>{{ opp.ticker.company_name }}</a><br>{{ opp.strategy.name }}<br>
              {{ opp.strategy.description }}<br>
                  {% for label, value in opp.translated_metrics.items %}
                      <strong>{{ label }}:</strong> {{ value }}<br>
                  {% endfor %}
              <strong>Breakeven price: </strong>{{ opp.breakeven_price }} <strong>Breakeven rise: </strong>{{ opp.breakeven_rise_percent }} %<br>
              <strong>Stop Loss Price:</strong><input type="number" step="any" name="stop_loss_price" value="{{ opp.stop_loss_price }}" style="width: 100px;"><br>
              <strong>Profit Taker Price:</strong><input type="number" step="any" name="profit_taker_price" value="{{ opp.profit_taker_price }}" style="width: 100px;"><br>
              <input type="checkbox" name="sl_triggered" {% if opp.stop_loss_triggered %}checked{% endif %}><strong> Stop loss triggered </strong><input type="submit" value="Update"><br>
              {{ opp.datetime_identified }}<br>
          </form>
    {% endfor %}
</body>
{% endblock %}

